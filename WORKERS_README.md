# üîß –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≤–æ—Ä–∫–µ—Ä–æ–≤

–°–∏—Å—Ç–µ–º–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–∞ –Ω–∞ –¥–≤–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –≤–æ—Ä–∫–µ—Ä–∞ –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏:

## üì• Scrapper Worker

**–§–∞–π–ª:** `backend/scrapper.py`  
**Docker:** `Dockerfile.scrapper`  
**–°–µ—Ä–≤–∏—Å:** `scrapper` –≤ docker-compose.yml

### –§—É–Ω–∫—Ü–∏–∏:
- üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Telegram-–∫–∞–Ω–∞–ª–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- üì® –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ—Å—Ç–æ–≤ –∏ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
- üîÑ –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–Ω–∞–ª–æ–≤ (fallback –º–µ—Ö–∞–Ω–∏–∑–º)
- üíì –û—Ç–ø—Ä–∞–≤–∫–∞ heartbeat —Å–∏–≥–Ω–∞–ª–æ–≤

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:
- –°—Ç–∞—Ç—É—Å —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ `scrapper_status`
- –£–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ –ø–æ–ª—è `should_run` –∏ `is_running`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∫–∞–Ω–∞–ª–æ–≤ –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç

## üì§ Publisher Worker

**–§–∞–π–ª:** `backend/publisher.py`  
**Docker:** `Dockerfile.publisher`  
**–°–µ—Ä–≤–∏—Å:** `publisher` –≤ docker-compose.yml

### –§—É–Ω–∫—Ü–∏–∏:
- ü§ñ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞ –ø–æ—Å—Ç–æ–≤ —á–µ—Ä–µ–∑ OpenRouter AI
- üìÖ –ü—É–±–ª–∏–∫–∞—Ü–∏—è –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤
- üöÄ –ù–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è –ø–æ—Å—Ç–æ–≤ (—Å—Ç–∞—Ç—É—Å "publishing")
- üì∏ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–µ–¥–∏–∞-–≥—Ä—É–ø–ø, —Ñ–æ—Ç–æ, –≤–∏–¥–µ–æ, –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- üíì –û—Ç–ø—Ä–∞–≤–∫–∞ heartbeat —Å–∏–≥–Ω–∞–ª–æ–≤

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:
- –°—Ç–∞—Ç—É—Å —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ `publisher_status`
- –£–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ –ø–æ–ª—è `should_run` –∏ `is_running`
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Å—Ç–æ–≤ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
- –ü—É–±–ª–∏–∫–∞—Ü–∏—è –∫–∞–∂–¥—ã–µ 15 —Å–µ–∫—É–Ω–¥

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –ù–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã:
- `scrapper_status` - —Å—Ç–∞—Ç—É—Å scrapper –≤–æ—Ä–∫–µ—Ä–∞
- `publisher_status` - —Å—Ç–∞—Ç—É—Å publisher –≤–æ—Ä–∫–µ—Ä–∞

### –ü–æ–ª—è —Å—Ç–∞—Ç—É—Å–∞:
- `should_run` - –¥–æ–ª–∂–µ–Ω –ª–∏ –≤–æ—Ä–∫–µ—Ä —Ä–∞–±–æ—Ç–∞—Ç—å
- `is_running` - —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ –≤–æ—Ä–∫–µ—Ä —Å–µ–π—á–∞—Å
- `last_heartbeat` - –ø–æ—Å–ª–µ–¥–Ω–∏–π heartbeat
- `started_at` - –≤—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞
- `stopped_at` - –≤—Ä–µ–º—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏

## üê≥ Docker

### –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤:
```bash
docker-compose up -d
```

### –ó–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ scrapper:
```bash
docker-compose up -d scrapper
```

### –ó–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ publisher:
```bash
docker-compose up -d publisher
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:
```bash
# Scrapper –ª–æ–≥–∏
docker-compose logs -f scrapper

# Publisher –ª–æ–≥–∏
docker-compose logs -f publisher
```

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è

–î–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:

```bash
# –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é backend
cd backend

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
alembic upgrade head
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ß–µ—Ä–µ–∑ API:
- `GET /api/scrapper/status` - —Å—Ç–∞—Ç—É—Å scrapper
- `GET /api/publisher/status` - —Å—Ç–∞—Ç—É—Å publisher
- `POST /api/scrapper/start` - –∑–∞–ø—É—Å–∫ scrapper
- `POST /api/scrapper/stop` - –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ scrapper
- `POST /api/publisher/start` - –∑–∞–ø—É—Å–∫ publisher
- `POST /api/publisher/stop` - –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ publisher

### –ß–µ—Ä–µ–∑ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö:
```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å scrapper
SELECT * FROM scrapper_status;

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å publisher
SELECT * FROM publisher_status;
```

## üîß –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

1. **–ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å**: –í–æ—Ä–∫–µ—Ä—ã –º–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞
2. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: –ú–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –∫–∞–∂–¥–æ–≥–æ –≤–æ—Ä–∫–µ—Ä–∞
3. **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**: –°–±–æ–π –æ–¥–Ω–æ–≥–æ –≤–æ—Ä–∫–µ—Ä–∞ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –¥—Ä—É–≥–æ–π
4. **–ì–∏–±–∫–æ—Å—Ç—å**: –ú–æ–∂–Ω–æ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å/–∑–∞–ø—É—Å–∫–∞—Ç—å –≤–æ—Ä–∫–µ—Ä—ã –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏
5. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –û—Ç–¥–µ–ª—å–Ω–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ –≤–æ—Ä–∫–µ—Ä–∞

## üö® –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

- –°—Ç–∞—Ä—ã–π `worker.py` –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—Ä–∏–º–µ–Ω–∏–ª–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –ö–∞–∂–¥—ã–π –≤–æ—Ä–∫–µ—Ä –∏–º–µ–µ—Ç —Å–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª
- Heartbeat —Å–∏–≥–Ω–∞–ª—ã –ø–æ–º–æ–≥–∞—é—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å "–∂–∏–≤–æ—Å—Ç—å" –≤–æ—Ä–∫–µ—Ä–æ–≤
- –í–æ—Ä–∫–µ—Ä—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–∏–≥–Ω–∞–ª–∞ `should_run = False`